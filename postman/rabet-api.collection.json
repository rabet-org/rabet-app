{
  "info": {
    "_postman_id": "rabet-unified-api",
    "name": "Rabet ‚Äî Full API",
    "description": "Unified collection of all Rabet API endpoints.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000/api",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "userEmail",
      "value": "",
      "type": "string"
    },
    {
      "key": "verificationToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "resetToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "adminAccessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "applicationId",
      "value": "",
      "type": "string"
    },
    {
      "key": "categoryId",
      "value": "",
      "type": "string"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Collection-level pre-request: auto-inject Bearer token for authenticated requests",
          "// Individual requests that need auth set a local variable `requiresAuth = true`",
          "const requiresAuth = pm.variables.get('requiresAuth');",
          "const token = pm.collectionVariables.get('accessToken');",
          "if (requiresAuth === 'true' && token) {",
          "  pm.request.headers.upsert({ key: 'Authorization', value: 'Bearer ' + token });",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Collection-level: always assert response is JSON when body is present",
          "if (pm.response.headers.get('Content-Type')?.includes('application/json')) {",
          "  pm.test('Response is valid JSON', () => pm.response.json());",
          "}"
        ]
      }
    }
  ],
  "item": [
    {
      "name": "1. Authentication",
      "item": [
        {
          "name": "1.1 Register",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "// Auto-populate email into collection variable for reuse in later requests",
                  "const body = JSON.parse(pm.request.body.raw);",
                  "pm.collectionVariables.set('userEmail', body.email);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 201 Created', () => pm.response.to.have.status(201));",
                  "",
                  "if (pm.response.code === 201) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('userId', res.user?.id ?? '');",
                  "  pm.collectionVariables.set('userEmail', res.user?.email ?? '');",
                  "  console.log('‚úÖ Registered user:', res.user?.email);",
                  "  console.log('‚ÑπÔ∏è  Check server logs or email inbox for verificationToken');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "register"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123\",\n  \"full_name\": \"John Doe\",\n  \"phone\": \"+201234567890\"\n}"
            }
          }
        },
        {
          "name": "1.2 Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "pm.test('Response has access_token', () => {",
                  "  pm.expect(pm.response.json()).to.have.property('access_token');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('accessToken',  res.access_token  ?? '');",
                  "  pm.collectionVariables.set('refreshToken', res.refresh_token ?? '');",
                  "  pm.collectionVariables.set('userId',       res.user?.id      ?? '');",
                  "  pm.collectionVariables.set('userEmail',    res.user?.email   ?? '');",
                  "  console.log('‚úÖ Logged in as:', res.user?.email);",
                  "  console.log('üîë Access token saved. Expires in:', res.expires_in, 'seconds');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"password\": \"SecurePass123\"\n}"
            }
          }
        },
        {
          "name": "1.4 Refresh Token",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const token = pm.collectionVariables.get('refreshToken');",
                  "if (!token) console.warn('‚ö†Ô∏è  refreshToken is empty ‚Äî run Login first');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('accessToken', res.access_token ?? '');",
                  "  console.log('‚úÖ Access token refreshed. Expires in:', res.expires_in, 'seconds');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/refresh",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "refresh"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh_token\": \"{{refreshToken}}\"\n}"
            }
          }
        },
        {
          "name": "1.5 Verify Email",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const token = pm.collectionVariables.get('verificationToken');",
                  "if (!token) {",
                  "  console.warn('‚ö†Ô∏è  verificationToken is empty.');",
                  "  console.warn('Paste the token from your email/server logs into the verificationToken collection variable.');",
                  "}"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ Email verified:', pm.response.json().message);",
                  "  pm.collectionVariables.set('verificationToken', '');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/verify-email",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "verify-email"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{verificationToken}}\"\n}"
            }
          }
        },
        {
          "name": "1.6 Request Password Reset",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ', pm.response.json().message);",
                  "  console.log('‚ÑπÔ∏è  Paste the token from your email/server logs into the resetToken collection variable');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/password-reset/request",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "password-reset",
                "request"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\"\n}"
            }
          }
        },
        {
          "name": "1.7 Confirm Password Reset",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const token = pm.collectionVariables.get('resetToken');",
                  "if (!token) {",
                  "  console.warn('‚ö†Ô∏è  resetToken is empty.');",
                  "  console.warn('Paste the token from your email/server logs into the resetToken collection variable.');",
                  "}"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ Password reset. Clearing saved tokens (all sessions revoked).');",
                  "  pm.collectionVariables.set('accessToken',  '');",
                  "  pm.collectionVariables.set('refreshToken', '');",
                  "  pm.collectionVariables.set('resetToken',   '');",
                  "  console.log('‚ÑπÔ∏è  Run Login again to get fresh tokens.');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/password-reset/confirm",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "password-reset",
                "confirm"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{resetToken}}\",\n  \"new_password\": \"NewSecurePass456\"\n}"
            }
          }
        },
        {
          "name": "1.8 Logout",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const token = pm.collectionVariables.get('refreshToken');",
                  "if (!token) console.warn('‚ö†Ô∏è  refreshToken is empty ‚Äî run Login first');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  pm.collectionVariables.set('refreshToken', '');",
                  "  console.log('‚úÖ Logged out. refreshToken cleared.');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/logout",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "logout"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh_token\": \"{{refreshToken}}\"\n}"
            }
          }
        },
        {
          "name": "1.9 Logout All Sessions",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const token = pm.collectionVariables.get('refreshToken');",
                  "if (!token) console.warn('‚ö†Ô∏è  refreshToken is empty ‚Äî run Login first');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('accessToken',  '');",
                  "  pm.collectionVariables.set('refreshToken', '');",
                  "  console.log('‚úÖ All sessions revoked:', res.sessions_revoked, 'session(s). Tokens cleared.');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/logout-all",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "logout-all"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh_token\": \"{{refreshToken}}\"\n}"
            }
          }
        }
      ],
      "description": "Registers, Logs in, and manages tokens."
    },
    {
      "name": "2. Users",
      "item": [
        {
          "name": "2.1 Get My Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Current User:', res.email);",
                  "  console.log('‚ÑπÔ∏è  Profile:', res.profile);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "users",
                "me"
              ]
            }
          }
        },
        {
          "name": "2.2 Update My Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Profile updated:', res.profile);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/me/profile",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "users",
                "me",
                "profile"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"full_name\": \"Jane Doe\",\n  \"phone\": \"+20123456789\",\n  \"avatar_url\": \"https://example.com/avatar.jpg\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "3. Categories",
      "item": [
        {
          "name": "3.1 List Categories",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Total active categories:', res.pagination.total);",
                  "  if (res.data && res.data.length > 0) {",
                  "    pm.collectionVariables.set('categoryId', res.data[0].id);",
                  "    console.log('‚ÑπÔ∏è  Saved first category ID for next request:', res.data[0].id);",
                  "  }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/categories?is_active=true&page=1&limit=20",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories"
              ],
              "query": [
                {
                  "key": "is_active",
                  "value": "true"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            }
          }
        },
        {
          "name": "3.2 Get Category by ID or Slug",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Category:', res.name, res.slug);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/categories/{{categoryId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories",
                "{{categoryId}}"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "4. Provider Applications",
      "item": [
        {
          "name": "4.0 Upload File",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Uploaded:', res.url);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/upload",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "upload"
              ]
            },
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": ""
                },
                {
                  "key": "folder",
                  "type": "text",
                  "value": "provider-docs"
                }
              ]
            }
          }
        },
        {
          "name": "4.1 Submit Application",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 201 Created', () => pm.response.to.have.status(201));",
                  "if (pm.response.code === 201) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('applicationId', res.id ?? '');",
                  "  console.log('‚úÖ Application submitted:', res.id);",
                  "  console.log('‚ÑπÔ∏è  Status:', res.application_status);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/provider-applications",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "provider-applications"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"provider_type\": \"agency\",\n  \"business_name\": \"Creative Agency Inc.\",\n  \"description\": \"Full-service creative agency with 5+ years of experience in digital marketing, web design, and branding. We deliver premium results for businesses of all sizes.\",\n  \"portfolio_url\": \"https://creativeagency.com\",\n  \"verification_docs\": {\n    \"business_license_url\": \"https://res.cloudinary.com/demo/raw/upload/sample.pdf\",\n    \"tax_id\": \"123456789\"\n  }\n}"
            }
          }
        },
        {
          "name": "4.2 Get My Application",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  pm.collectionVariables.set('applicationId', res.id ?? '');",
                  "  console.log('‚ÑπÔ∏è  Status:', res.application_status);",
                  "  if (res.rejection_reason) console.log('‚ùå Rejection:', res.rejection_reason);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/provider-applications/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "provider-applications",
                "me"
              ]
            }
          }
        },
        {
          "name": "4.3 Update My Application",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ Application updated. Status:', pm.response.json().application_status);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/provider-applications/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "provider-applications",
                "me"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Updated description ‚Äî full-service creative agency with 5+ years of experience in digital marketing, web design, and branding. We deliver premium results.\",\n  \"portfolio_url\": \"https://newportfolio.com\"\n}"
            }
          }
        },
        {
          "name": "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Admin ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}",
              "host": [
                "{{baseUrl}}"
              ]
            }
          }
        },
        {
          "name": "4.4 [Admin] List Applications",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚ÑπÔ∏è  Total applications:', res.pagination.total);",
                  "  res.data.forEach(a => console.log(`  ${a.business_name} ‚Äî ${a.application_status}`));",
                  "  if (res.data.length > 0) {",
                  "    pm.collectionVariables.set('applicationId', res.data[0].id);",
                  "    console.log('üìã First application ID saved:', res.data[0].id);",
                  "  }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminAccessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/provider-applications?status=pending&page=1&limit=20",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "provider-applications"
              ],
              "query": [
                {
                  "key": "status",
                  "value": "pending"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            }
          }
        },
        {
          "name": "4.5 [Admin] Approve Application",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const id = pm.collectionVariables.get('applicationId');",
                  "if (!id) console.warn('‚ö†Ô∏è  applicationId is empty ‚Äî run List or Submit first');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ', pm.response.json().message);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{adminAccessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/provider-applications/{{applicationId}}/review",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "provider-applications",
                "{{applicationId}}",
                "review"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"approve\"\n}"
            }
          }
        },
        {
          "name": "4.6 [Admin] Reject Application",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const id = pm.collectionVariables.get('applicationId');",
                  "if (!id) console.warn('‚ö†Ô∏è  applicationId is empty ‚Äî run List or Submit first');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  console.log('‚úÖ', pm.response.json().message);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{adminAccessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/provider-applications/{{applicationId}}/review",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "provider-applications",
                "{{applicationId}}",
                "review"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"reject\",\n  \"rejection_reason\": \"Insufficient documentation. Please upload a valid business license.\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "5. Provider Profiles",
      "item": [
        {
          "name": "5.1 Get My Provider Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Provider:', res.business_name);",
                  "  console.log('‚ÑπÔ∏è  Services:', res.services.map(s => s.name).join(', '));",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/providers/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "providers",
                "me"
              ]
            }
          }
        },
        {
          "name": "5.2 Update My Provider Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Profile updated:', res.business_name);",
                  "  console.log('‚ÑπÔ∏è  New Services:', res.services.map(s => s.name).join(', '));",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/providers/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "providers",
                "me"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Updated description for my awesome creative agency.\",\n  \"portfolio_url\": \"https://awesomeportfolio.com\",\n  \"service_category_ids\": [\n    \"YOUR-CATEGORY-ID-HERE\"\n  ]\n}"
            }
          }
        },
        {
          "name": "5.3 List Providers (Directory)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status is 200 OK', () => pm.response.to.have.status(200));",
                  "if (pm.response.code === 200) {",
                  "  const res = pm.response.json();",
                  "  console.log('‚úÖ Total providers matching filters:', res.pagination.total);",
                  "  if (res.data && res.data.length > 0) {",
                  "    res.data.forEach(p => console.log(`  ${p.business_name} ‚≠ê ${p.average_rating}`));",
                  "  }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/providers?page=1&limit=20&min_rating=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "providers"
              ],
              "query": [
                {
                  "key": "category_slug",
                  "value": "web-design",
                  "disabled": true
                },
                {
                  "key": "is_verified",
                  "value": "true",
                  "disabled": true
                },
                {
                  "key": "min_rating",
                  "value": "0"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            }
          }
        }
      ]
    }
  ]
}